.detail-title-wrapper.e2e-story-header(ng-class="{readonly: !vm.permissions.canEdit}")
    h2.detail-title-text.ng-animate-disabled(
        ng-show="!vm.editMode"
        ng-hide="vm.editMode"
    )
        span.detail-subject.e2e-title-subject(
            ng-click="vm.editSubject(true)"
            ng-if="vm.permissions.canEdit"
            ng-bind-html="vm.item.subject | emojify"
        )
        span.detail-subject.e2e-title-subject(
            ng-if="!vm.permissions.canEdit"
            ng-bind-html="vm.item.subject | emojify"
        )
        a(
            href=""
            ng-if="vm.permissions.canEdit"
            ng-click="vm.editSubject(true)"
        )
            tg-svg.detail-edit.e2e-detail-edit(svg-icon="icon-edit")
        tg-due-date(
            due-date="vm.item.due_date"
            is-closed="vm.item.is_closed"
            ng-if="vm.item.due_date"
            obj-type="{{ vm.objType }}"
        )
    .edit-title-wrapper(ng-if="vm.editMode")
        input.edit-title-input.e2e-title-input(
            type="text"
            ng-model="vm.item.subject"
            maxlength="500"
            autofocus
            required
            ng-keydown="vm.onKeyDown($event)"
        )
        button.edit-title-button.save-title-button.e2e-title-button(
            ng-click="vm.saveSubject()"
            tg-loading="vm.loadingSubject"
        )
            tg-svg(
                svg-icon="icon-save"
            )
        button.edit-title-button.cancel-title-button.e2e-cancel-title-button(
            ng-click="vm.cancelEdit(false)"
        )
            tg-svg(svg-icon="icon-close")

.detail-project
    .project-name(ng-if="vm.project.name ") {{ vm.project.name }}
    .section-name {{ vm.sectionName }}

//- Task belongs to US
.detail-header-line.task-belongs-to(
    ng-if="vm.item.user_story_extra_info"
    tg-check-permission="view_us"
)
    span(translate="TASK.OWNER_US")
    a(
        tg-nav="project-userstories-detail:project=vm.project.slug,ref=vm.item.user_story_extra_info.ref"
        title="{{'TASK.TITLE_LINK_GO_OWNER' | translate}}"
    )
        span.item-ref {{'#' + vm.item.user_story_extra_info.ref}}
        span(ng-bind-html="vm.item.user_story_extra_info.subject | emojify")
        tg-belong-to-epics(
            ng-if="::vm.item.user_story_extra_info.epics"
            epics="::vm.item.user_story_extra_info.epics"
            format="pill"
        )

//- Blocked description
.detail-header-line.block-desc-container(ng-show="vm.item.is_blocked")
    span.block-description-title(translate="COMMON.BLOCKED")
    span.block-description(ng-if="vm.item.blocked_note") {{vm.item.blocked_note}}
